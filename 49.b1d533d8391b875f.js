"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[49],{5049:(P,l,o)=>{o.r(l),o.d(l,{AnalysisHubComponent:()=>H});var e=o(4438),c=o(177),d=o(9679),p=o(1626),h=o(1097);let _=(()=>{class a{constructor(){this.http=(0,e.WQX)(p.Qq),this.baseUrl=`${(0,h.G)()}/recommendations`}getFixtureRecommendation(n){new URL(`${this.baseUrl}/fixture`,window.location.origin);const t=new URLSearchParams;return null!=n.fixtureId&&t.set("fixtureId",String(n.fixtureId)),t.set("leagueId",String(n.leagueId)),null!=n.seasonId&&t.set("seasonId",String(n.seasonId)),null!=n.homeTeamId&&t.set("homeTeamId",String(n.homeTeamId)),null!=n.awayTeamId&&t.set("awayTeamId",String(n.awayTeamId)),n.leagueName&&t.set("leagueName",n.leagueName),n.homeTeamName&&t.set("homeTeamName",n.homeTeamName),n.awayTeamName&&t.set("awayTeamName",n.awayTeamName),t.set("_ts",String(Date.now())),this.http.get(`${this.baseUrl}/fixture?${t.toString()}`)}static{this.\u0275fac=function(s){return new(s||a)}}static{this.\u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();const F=()=>["/fixtures"],u=()=>[],y=()=>["/played-matches-summary"],k=(a,i,n)=>({h2hHome:a,h2hAway:i,leagueId:n}),m=()=>["/streak-insights"],g=a=>({team:a});function x(a,i){1&a&&(e.j41(0,"div",5)(1,"div",6),e.EFF(2,"Choose a Fixture"),e.k0s(),e.j41(3,"div",7),e.EFF(4,"To run automatic analysis, select a fixture from the Fixtures page."),e.k0s(),e.j41(5,"div",8)(6,"a",9),e.EFF(7,"Go to Fixtures"),e.k0s()()()),2&a&&(e.R7$(6),e.Y8G("routerLink",e.lJ4(1,F)))}function I(a,i){1&a&&(e.j41(0,"div",7),e.EFF(1,"Loading recommendation\u2026"),e.k0s())}function b(a,i){if(1&a&&(e.j41(0,"div",21)(1,"span",25),e.EFF(2),e.k0s()()),2&a){const n=e.XpG(3);e.R7$(2),e.SpI("\u26a0\ufe0f Divergence: ",n.rec.divergenceNote||"Fixture vs Streak conflict","")}}function v(a,i){if(1&a&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&a){const n=e.XpG(3);e.R7$(),e.SpI(" (",n.rec.overUnderProbability,"% probability)")}}function T(a,i){if(1&a&&(e.j41(0,"span",26),e.EFF(1),e.k0s()),2&a){const n=i.$implicit;e.R7$(),e.JRh(n)}}function w(a,i){if(1&a&&(e.j41(0,"div",27),e.EFF(1),e.k0s()),2&a){const n=e.XpG(3);e.R7$(),e.JRh(n.rec.correctScoreContext)}}function C(a,i){if(1&a&&(e.qex(0),e.j41(1,"span",14),e.EFF(2),e.k0s(),e.bVm()),2&a){const n=e.XpG(3);e.R7$(),e.Y8G("ngClass",n.sampleClass(n.rec.homeStreakSampleLevel)),e.R7$(),e.SpI("Home streak samples: ",n.rec.homeStreakInstances,"")}}function N(a,i){if(1&a&&(e.j41(0,"span",25),e.EFF(1),e.k0s()),2&a){const n=e.XpG(3);e.R7$(),e.SpI("\u26a0\ufe0f ",n.rec.homeStreakNote||"No streak data available for Home \u2014 prediction weighted mainly on Fixture Analysis","")}}function R(a,i){if(1&a&&(e.qex(0),e.j41(1,"span",14),e.EFF(2),e.k0s(),e.bVm()),2&a){const n=e.XpG(3);e.R7$(),e.Y8G("ngClass",n.sampleClass(n.rec.awayStreakSampleLevel)),e.R7$(),e.SpI("Away streak samples: ",n.rec.awayStreakInstances,"")}}function E(a,i){if(1&a&&(e.j41(0,"span",25),e.EFF(1),e.k0s()),2&a){const n=e.XpG(3);e.R7$(),e.SpI("\u26a0\ufe0f ",n.rec.awayStreakNote||"No streak data available for Away \u2014 prediction weighted mainly on Fixture Analysis","")}}function S(a,i){if(1&a&&(e.qex(0),e.j41(1,"div",17)(2,"div",12)(3,"div",18),e.EFF(4),e.k0s(),e.j41(5,"div",19),e.EFF(6),e.k0s(),e.DNE(7,b,3,1,"div",20),e.k0s(),e.j41(8,"div",12)(9,"div"),e.EFF(10,"BTTS: "),e.j41(11,"strong"),e.EFF(12),e.k0s()(),e.j41(13,"div"),e.EFF(14,"Over/Under: "),e.j41(15,"strong"),e.EFF(16),e.k0s(),e.DNE(17,v,2,1,"span",4),e.k0s()(),e.j41(18,"div",12)(19,"div",7),e.EFF(20,"Correct Scores"),e.k0s(),e.j41(21,"div",21),e.DNE(22,T,2,1,"span",22),e.k0s(),e.DNE(23,w,2,1,"div",23),e.k0s()(),e.j41(24,"div",8),e.DNE(25,C,3,2,"ng-container",24)(26,N,2,1,"ng-template",null,0,e.C5r)(28,R,3,2,"ng-container",24)(29,E,2,1,"ng-template",null,1,e.C5r),e.k0s(),e.bVm()),2&a){const n=e.sdS(27),s=e.sdS(30),t=e.XpG(2);e.R7$(4),e.SpI("Outcome: ",t.friendlyOutcome(t.rec.outcomeLean),""),e.R7$(2),e.JRh(t.rec.confidenceBreakdownText||"Confidence: "+t.rec.outcomeConfidence+"/100"),e.R7$(),e.Y8G("ngIf",t.rec.divergenceWarning),e.R7$(5),e.JRh(t.friendlyBtts(t.rec.bttsRecommendation,t.rec.overUnderRecommendation)),e.R7$(4),e.JRh(t.rec.overUnderRecommendation),e.R7$(),e.Y8G("ngIf",null!=t.rec.overUnderProbability),e.R7$(5),e.Y8G("ngForOf",t.rec.correctScoreShortlist),e.R7$(),e.Y8G("ngIf",t.rec.correctScoreContext),e.R7$(2),e.Y8G("ngIf",(t.rec.homeStreakInstances||0)>0)("ngIfElse",n),e.R7$(3),e.Y8G("ngIf",(t.rec.awayStreakInstances||0)>0)("ngIfElse",s)}}function $(a,i){if(1&a&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&a){const n=i.$implicit;e.R7$(),e.JRh(n)}}function j(a,i){if(1&a&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&a){const n=i.$implicit;e.R7$(),e.JRh(n)}}function A(a,i){if(1&a&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&a){const n=i.$implicit;e.R7$(),e.JRh(n)}}function G(a,i){if(1&a&&(e.j41(0,"div",5)(1,"div",6),e.EFF(2,"Why this pick"),e.k0s(),e.j41(3,"ul"),e.DNE(4,A,2,1,"li",15),e.k0s()()),2&a){const n=e.XpG(2);e.R7$(4),e.Y8G("ngForOf",null==n.rec?null:n.rec.rationale)}}function O(a,i){if(1&a&&(e.qex(0),e.j41(1,"div",5)(2,"div",6),e.EFF(3,"\u2705 Final Recommendation"),e.k0s(),e.j41(4,"div",7),e.EFF(5,"Unified system-generated pick based on Fixture Analysis + Streak Insights"),e.k0s(),e.DNE(6,I,2,0,"div",10)(7,S,31,12,"ng-container",4),e.k0s(),e.j41(8,"div",5)(9,"div",6),e.EFF(10,"Contribution by stage"),e.k0s(),e.j41(11,"div",11)(12,"div",12)(13,"div",7),e.EFF(14,"Matches used from Played Matches Summary"),e.k0s(),e.j41(15,"div")(16,"strong"),e.EFF(17),e.k0s(),e.j41(18,"span",7),e.EFF(19,"(H2H window)"),e.k0s()(),e.j41(20,"div",13)(21,"span",14),e.EFF(22),e.k0s(),e.j41(23,"span",14),e.EFF(24),e.k0s()()(),e.j41(25,"div",12)(26,"div")(27,"strong"),e.EFF(28,"Fixture Analysis contribution"),e.k0s()(),e.j41(29,"ul"),e.DNE(30,$,2,1,"li",15),e.k0s()(),e.j41(31,"div",12)(32,"div")(33,"strong"),e.EFF(34,"Streak Insight contribution"),e.k0s()(),e.j41(35,"ul"),e.DNE(36,j,2,1,"li",15),e.k0s()()()(),e.j41(37,"div",5)(38,"div",6),e.EFF(39,"Details"),e.k0s(),e.j41(40,"div",11)(41,"div",12)(42,"a",16),e.EFF(43,"Open Fixture Analysis"),e.k0s()(),e.j41(44,"div",12)(45,"a",16),e.EFF(46,"Open Streak Insight (Home)"),e.k0s()(),e.j41(47,"div",12)(48,"a",16),e.EFF(49,"Open Streak Insight (Away)"),e.k0s()()()(),e.DNE(50,G,5,1,"div",3),e.bVm()),2&a){let n,s;const t=e.XpG();e.R7$(6),e.Y8G("ngIf",t.loading),e.R7$(),e.Y8G("ngIf",!t.loading&&t.rec),e.R7$(10),e.JRh(null!=(null==t.rec?null:t.rec.analysisMatchesCount)?null==t.rec?null:t.rec.analysisMatchesCount:"?"),e.R7$(4),e.Y8G("ngClass",t.sampleClass(null==t.rec?null:t.rec.homeStreakSampleLevel)),e.R7$(),e.SpI("Home streak instances: ",null!==(n=null==t.rec?null:t.rec.homeStreakInstances)&&void 0!==n?n:0,""),e.R7$(),e.Y8G("ngClass",t.sampleClass(null==t.rec?null:t.rec.awayStreakSampleLevel)),e.R7$(),e.SpI("Away streak instances: ",null!==(s=null==t.rec?null:t.rec.awayStreakInstances)&&void 0!==s?s:0,""),e.R7$(6),e.Y8G("ngForOf",(null==t.rec?null:t.rec.fixtureAnalysisFactors)||e.lJ4(16,u)),e.R7$(6),e.Y8G("ngForOf",(null==t.rec?null:t.rec.streakInsightFactors)||e.lJ4(17,u)),e.R7$(6),e.Y8G("routerLink",e.lJ4(18,y))("queryParams",e.sMw(19,k,t.homeTeamName,t.awayTeamName,t.leagueId)),e.R7$(3),e.Y8G("routerLink",e.lJ4(23,m))("queryParams",e.eq3(24,g,t.homeTeamName)),e.R7$(3),e.Y8G("routerLink",e.lJ4(26,m))("queryParams",e.eq3(27,g,t.awayTeamName)),e.R7$(2),e.Y8G("ngIf",null==t.rec||null==t.rec.rationale?null:t.rec.rationale.length)}}let H=(()=>{class a{constructor(){this.route=(0,e.WQX)(d.nX),this.svc=(0,e.WQX)(_),this.rec=null,this.loading=!0,this.needParams=!1,this.fixtureId=null,this.seasonId=null,this.homeTeamId=null,this.awayTeamId=null,this.leagueName=null,this.homeTeamName=null,this.awayTeamName=null}friendlyOutcome(n){switch((n||"UNKNOWN").toUpperCase()){case"HOME":return"Home Win";case"AWAY":return"Away Win";case"DRAW":return"Draw";default:return"No clear lean"}}friendlyBtts(n,s){const t=(n||"").toLowerCase();if("yes"===t||"no"===t)return t.charAt(0).toUpperCase()+t.slice(1);const f=(s||"").toLowerCase();return f.startsWith("under")?"Lean No":f.startsWith("over")?"Lean Yes":"Lean"}ngOnInit(){this.route.queryParamMap.subscribe(n=>{this.fixtureId=r(n.get("fixtureId")),this.leagueId=r(n.get("leagueId"))??0,this.seasonId=r(n.get("seasonId")),this.homeTeamId=r(n.get("homeTeamId")),this.awayTeamId=r(n.get("awayTeamId")),this.leagueName=n.get("leagueName"),this.homeTeamName=n.get("homeTeamName"),this.awayTeamName=n.get("awayTeamName");const s=!!this.leagueId,t=!!this.homeTeamId&&!!this.awayTeamId||!(!this.homeTeamName||!this.homeTeamName.trim())&&!(!this.awayTeamName||!this.awayTeamName.trim());if(this.needParams=!(s&&t),this.needParams)return this.loading=!1,void(this.rec=null);this.fetch()})}fetch(){this.needParams?this.loading=!1:(this.loading=!0,this.svc.getFixtureRecommendation({fixtureId:this.fixtureId??void 0,leagueId:this.leagueId,seasonId:this.seasonId??void 0,homeTeamId:this.homeTeamId??void 0,awayTeamId:this.awayTeamId??void 0,leagueName:this.leagueName??void 0,homeTeamName:this.homeTeamName??void 0,awayTeamName:this.awayTeamName??void 0}).subscribe({next:n=>{this.rec=n,this.loading=!1},error:()=>{this.loading=!1}}))}sampleClass(n){switch((n||"UNKNOWN").toUpperCase()){case"HIGH":return"green";case"MEDIUM":return"amber";case"LOW":return"red";default:return""}}static{this.\u0275fac=function(s){return new(s||a)}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-analysis-hub"]],standalone:!0,features:[e.aNF],decls:3,vars:2,consts:[["homeNoteTpl",""],["awayNoteTpl",""],[1,"container"],["class","card",4,"ngIf"],[4,"ngIf"],[1,"card"],[1,"title"],[1,"muted"],[1,"chips",2,"margin-top","8px"],[1,"btn",3,"routerLink"],["class","muted",4,"ngIf"],[1,"row"],[1,"col"],[1,"chips",2,"margin-top","6px"],[1,"chip",3,"ngClass"],[4,"ngFor","ngForOf"],[1,"btn",3,"routerLink","queryParams"],[1,"row",2,"align-items","center"],[2,"font-weight","800","font-size","18px","color","#fff"],["title","Confidence breakdown",1,"muted"],["class","chips",4,"ngIf"],[1,"chips"],["class","score-pill",4,"ngFor","ngForOf"],["class","muted","style","margin-top:6px;",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"chip","warn"],[1,"score-pill"],[1,"muted",2,"margin-top","6px"]],template:function(s,t){1&s&&(e.j41(0,"div",2),e.DNE(1,x,8,2,"div",3)(2,O,51,29,"ng-container",4),e.k0s()),2&s&&(e.R7$(),e.Y8G("ngIf",t.needParams),e.R7$(),e.Y8G("ngIf",!t.needParams))},dependencies:[c.MD,c.YU,c.Sq,c.bT,d.Wk],styles:["[_nghost-%COMP%]{display:block;color:#e0e0e0;background:#0a0a0a;font-family:Inter,Roboto,Arial,sans-serif}.container[_ngcontent-%COMP%]{max-width:1100px;margin:0 auto;padding:12px}.card[_ngcontent-%COMP%]{background:#1a1a1a;border:1px solid #333;border-radius:12px;padding:12px;margin-bottom:12px}.title[_ngcontent-%COMP%]{font-size:22px;font-weight:800;color:#fff}.muted[_ngcontent-%COMP%]{color:#9aa0a6}.chips[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}.chip[_ngcontent-%COMP%]{border-radius:999px;padding:4px 10px;font-size:12px;border:1px solid #2d2d2d;background:#101010}.chip.red[_ngcontent-%COMP%]{background:#3a1111;color:#ff6b6b;border-color:#7a1f1f}.chip.amber[_ngcontent-%COMP%]{background:#2f2a11;color:#ffd166;border-color:#7a6a1f}.chip.green[_ngcontent-%COMP%]{background:#113a2a;color:#28a745;border-color:#1f7a4c}.chip.warn[_ngcontent-%COMP%]{background:#3a1111;color:#ff6b6b;border-color:#7a1f1f}.row[_ngcontent-%COMP%]{display:flex;gap:12px;flex-wrap:wrap}.col[_ngcontent-%COMP%]{flex:1;min-width:260px}.btn[_ngcontent-%COMP%]{display:inline-block;border-radius:8px;padding:8px 12px;border:1px solid #2d2d2d;background:#2a2a2a;color:#fff;text-decoration:none;font-weight:700}.btn[_ngcontent-%COMP%]:hover{background:#333}.score-pill[_ngcontent-%COMP%]{background:#0b2f55;border:1px solid #123e73;color:#d1e9ff;border-radius:8px;padding:4px 8px;font-weight:800}"]})}}return a})();function r(a){if(null==a)return null;const i=Number(a);return Number.isFinite(i)?i:null}}}]);