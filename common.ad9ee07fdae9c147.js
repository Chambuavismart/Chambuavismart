"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[76],{5220:(x,g,i)=>{i.d(g,{R:()=>T});var p=i(4438),v=i(1626),u=i(253),I=i(1097);let T=(()=>{class d{constructor(){this.http=(0,p.WQX)(v.Qq),this.baseUrl=`${(0,I.G)()}/match-analysis`,this.cache=new Map}keyOf(h){return JSON.stringify({leagueId:h.leagueId,seasonId:h.seasonId??null,homeTeamId:h.homeTeamId??null,awayTeamId:h.awayTeamId??null,homeTeamName:h.homeTeamName?.trim().toLowerCase()??null,awayTeamName:h.awayTeamName?.trim().toLowerCase()??null,analysisType:h.analysisType??"match"})}analyze(h){if(h.refresh)return this.http.post(`${this.baseUrl}/analyze`,h);const n=this.keyOf(h),o=this.cache.get(n);if(o)return o;const t=this.http.post(`${this.baseUrl}/analyze`,h).pipe((0,u.t)(1));return this.cache.set(n,t),t}static{this.\u0275fac=function(n){return new(n||d)}}static{this.\u0275prov=p.jDH({token:d,factory:d.\u0275fac,providedIn:"root"})}}return d})()},2983:(x,g,i)=>{i.d(g,{n:()=>d});var p=i(4438),v=i(1626),u=i(1985),I=i(1097),T=i(5925);let d=(()=>{class m{constructor(){this.http=(0,p.WQX)(v.Qq),this.leagueContext=(0,p.WQX)(T.K),this.baseUrl=`${(0,I.G)()}/teams`}searchTeams(n){const o=this.leagueContext.getCurrentLeagueId(),t={query:n};return o&&(t.leagueId=String(o)),this.http.get(`${this.baseUrl}/search`,{params:t})}searchTeamsScoped(n,o){if("string"!=typeof n||!n||n.trim().length<2)return console.error("[TeamService] Invalid search query:",n),new u.c(a=>{a.next([]),a.complete()});const t=n.trim(),l="number"==typeof o?o:this.leagueContext.getCurrentLeagueId()??void 0,c="number"==typeof l?`${this.baseUrl}/search?query=${encodeURIComponent(t)}&leagueId=${l}`:`${this.baseUrl}/search?query=${encodeURIComponent(t)}`;return console.log("[TeamService] GET",c),this.http.get(c)}findByName(n,o){if("string"!=typeof n||!n||n.trim().length<2)return console.error("[TeamService] Invalid team name for by-name:",n),new u.c(a=>{a.next(null),a.complete()});const t=n.trim(),l="number"==typeof o?o:this.leagueContext.getCurrentLeagueId()??void 0,c="number"==typeof l?`${this.baseUrl}/by-name?name=${encodeURIComponent(t)}&leagueId=${l}`:`${this.baseUrl}/by-name?name=${encodeURIComponent(t)}`;return console.log("[TeamService] GET",c),this.http.get(c)}findByNameWithDisambiguation(n,o){return new u.c(t=>{if("string"!=typeof n||!n||n.trim().length<2)return console.error("[TeamService] Invalid team name for by-name(disambiguation):",n),t.next({team:null,notFound:!0,status:400}),void t.complete();const l=n.trim(),c="number"==typeof o?o:this.leagueContext.getCurrentLeagueId()??void 0,a="number"==typeof c?`${this.baseUrl}/by-name?name=${encodeURIComponent(l)}&leagueId=${c}`:`${this.baseUrl}/by-name?name=${encodeURIComponent(l)}`;console.log("[TeamService] GET",a),this.http.get(a,{observe:"response"}).subscribe({next:e=>{t.next({team:e.body??null,status:e.status}),t.complete()},error:e=>{409===e.status&&e.error&&e.error.candidates?(t.next({candidates:e.error.candidates||[],conflict:!0,status:409}),t.complete()):404===e.status?(t.next({team:null,notFound:!0,status:404}),t.complete()):(console.warn("[TeamService] by-name unexpected error",e),t.next({team:null,status:e.status}),t.complete())}})})}getPriorOutcomes(n,o){const t=(n||"").trim();if(!t)return new u.c(a=>{a.next(null),a.complete()});const l="number"==typeof o?o:this.leagueContext.getCurrentLeagueId()??void 0,c="number"==typeof l?`${this.baseUrl}/${encodeURIComponent(t)}/prior-outcomes?leagueId=${l}`:`${this.baseUrl}/${encodeURIComponent(t)}/prior-outcomes`;return this.http.get(c)}getLastPlayedByName(n){const o=(n||"").trim();if(!o)return new u.c(l=>{l.next(null),l.complete()});const t=`${this.baseUrl}/${encodeURIComponent(o)}/last-played`;return this.http.get(t)}getLastPlayedListByName(n,o=2){const t=(n||"").trim();if(!t)return new u.c(c=>{c.next([]),c.complete()});const l=`${this.baseUrl}/${encodeURIComponent(t)}/last-played-list?limit=${Math.max(1,Math.min(o,20))}`;return this.http.get(l)}getLast40TopStreaksByName(n){const o=(n||"").trim();if(!o)return new u.c(l=>{l.next(null),l.complete()});const t=`${this.baseUrl}/${encodeURIComponent(o)}/last40-top-streaks`;return this.http.get(t)}getScopedTeamId(n,o){return new u.c(t=>{const l="number"==typeof o?o:this.leagueContext.getCurrentLeagueId()??void 0;if(console.debug("[TeamService] getScopedTeamId start",{teamName:n,leagueId:l}),"string"!=typeof n||!n||n.trim().length<2)return console.error("[TeamService] Invalid team name for lookup:",n),t.next(null),void t.complete();const c=n.trim();this.findByName(c,l).subscribe({next:a=>{a?.id?(console.debug("[TeamService] by-name resolved",a),t.next(a.id),t.complete()):(console.debug("[TeamService] by-name empty; falling back to search"),this.searchTeamsScoped(c,l).subscribe({next:e=>{console.debug("[TeamService] search result",e),t.next(e&&e.length?e[0].id:null),t.complete()},error:e=>{console.warn("[TeamService] search error",e),t.next(null),t.complete()}}))},error:a=>{console.warn("[TeamService] by-name error; falling back to search",a),this.searchTeamsScoped(c,l).subscribe({next:e=>{console.debug("[TeamService] search result (fallback)",e),t.next(e&&e.length?e[0].id:null),t.complete()},error:e=>{console.warn("[TeamService] search error (fallback)",e),t.next(null),t.complete()}})}})})}static{this.\u0275fac=function(o){return new(o||m)}}static{this.\u0275prov=p.jDH({token:m,factory:m.\u0275fac,providedIn:"root"})}}return m})()},9431:(x,g,i)=>{i.d(g,{B:()=>c});var p=i(8359);class v extends p.yU{constructor(e,s){super()}schedule(e,s=0){return this}}const u={setInterval(a,e,...s){const{delegate:r}=u;return r?.setInterval?r.setInterval(a,e,...s):setInterval(a,e,...s)},clearInterval(a){const{delegate:e}=u;return(e?.clearInterval||clearInterval)(a)},delegate:void 0};var I=i(7908),d=i(6129);class m{constructor(e,s=m.now){this.schedulerActionCtor=e,this.now=s}schedule(e,s=0,r){return new this.schedulerActionCtor(this,e).schedule(r,s)}}m.now=d.U.now;const n=new class h extends m{constructor(e,s=m.now){super(e,s),this.actions=[],this._active=!1}flush(e){const{actions:s}=this;if(this._active)return void s.push(e);let r;this._active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=s.shift());if(this._active=!1,r){for(;e=s.shift();)e.unsubscribe();throw r}}}(class T extends v{constructor(e,s){super(e,s),this.scheduler=e,this.work=s,this.pending=!1}schedule(e,s=0){var r;if(this.closed)return this;this.state=e;const f=this.id,y=this.scheduler;return null!=f&&(this.id=this.recycleAsyncId(y,f,s)),this.pending=!0,this.delay=s,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(y,this.id,s),this}requestAsyncId(e,s,r=0){return u.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,s,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return s;null!=s&&u.clearInterval(s)}execute(e,s){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(e,s);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,s){let f,r=!1;try{this.work(e)}catch(y){r=!0,f=y||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),f}unsubscribe(){if(!this.closed){const{id:e,scheduler:s}=this,{actions:r}=s;this.work=this.state=this.scheduler=null,this.pending=!1,(0,I.o)(r,this),null!=e&&(this.id=this.recycleAsyncId(s,e,null)),this.delay=null,super.unsubscribe()}}});var t=i(9974),l=i(4360);function c(a,e=n){return(0,t.N)((s,r)=>{let f=null,y=null,C=null;const U=()=>{if(f){f.unsubscribe(),f=null;const _=y;y=null,r.next(_)}};function $(){const _=C+a,E=e.now();if(E<_)return f=this.schedule(void 0,_-E),void r.add(f);U()}s.subscribe((0,l._)(r,_=>{y=_,C=e.now(),f||(f=e.schedule($,a),r.add(f))},()=>{U(),r.complete()},void 0,()=>{y=f=null}))})}},3294:(x,g,i)=>{i.d(g,{F:()=>I});var p=i(3669),v=i(9974),u=i(4360);function I(d,m=p.D){return d=d??T,(0,v.N)((h,n)=>{let o,t=!0;h.subscribe((0,u._)(n,l=>{const c=m(l);(t||!d(o,c))&&(t=!1,o=c,n.next(l))}))})}function T(d,m){return d===m}}}]);